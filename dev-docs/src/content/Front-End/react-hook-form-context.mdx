# Micro Frontend(MFE) + React Hook Form Context Issue ë¶„ì„ ë¦¬í¬íŠ¸

---

## ğŸ›‘ ë‚´ê°€ ë§ë‹¥ëœ¨ë¦° ë¬¸ì œ

- Micro Frontend(MFE) ì•„í‚¤í…ì²˜(ì˜ˆ: shell/remote êµ¬ì¡°, module federation, pnpm workspace)ì—ì„œ  
  ê³µìš© UI íŒ¨í‚¤ì§€(packages/ui)ë¡œ shadcn-ui ê¸°ë°˜ Form ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì œê³µí•˜ê³ ,
- remote(auth) ì•±ì˜ í¼ í˜ì´ì§€(SignUpPage ë“±)ì—ì„œ `<FormProvider>`ë¡œ ê°ì‹¼ í•˜ìœ„ì— `<EmailInput />` ë“±ì„ ì‚¬ìš©í–ˆìŒ.
- **ë¶„ëª…íˆ ëª¨ë“  êµ¬ì¡°ì™€ ì½”ë“œë¥¼ ë§ì·„ëŠ”ë°ë„,**
- EmailInput ë‚´ë¶€ì—ì„œ `useFormContext()` í˜¸ì¶œ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°˜ë³µ ë°œìƒ:

TypeError: Cannot destructure property 'control' of '(0 , react_hook_form__WEBPACK_IMPORTED_MODULE_2__.useFormContext)(...)' as it is null.


---

## ğŸ” ì›ì¸

### 1. **React ContextëŠ” "ë™ì¼í•œ JS ì¸ìŠ¤í„´ìŠ¤"ì—ì„œë§Œ ë™ì‘**
- Reactì˜ Context ì‹œìŠ¤í…œì€ **ì‹¤ì œ JS ë©”ëª¨ë¦¬ ìƒ ë™ì¼í•œ context ê°ì²´**ì—¬ì•¼  
Provider â†’ Consumer ì—°ê²°ì´ ì •ìƒ ë™ì‘í•œë‹¤.
- shell/remote, ê³µìš© UI íŒ¨í‚¤ì§€, ì•±ë³„ node_modules ë“±  
ì—¬ëŸ¬ ìœ„ì¹˜ì— react-hook-formì´ ì¤‘ë³µ ì„¤ì¹˜/ë¡œë“œë˜ë©´  
**ì„œë¡œ ë‹¤ë¥¸ contextê°€ ìƒê²¨ì„œ ê³µìœ ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.**

### 2. **pnpm workspace/micro frontend êµ¬ì¡°ì—ì„œ ì¤‘ë³µ ì„¤ì¹˜ ìœ„í—˜**
- pnpmì€ symlink ë°©ì‹ìœ¼ë¡œ ëŒ€ë¶€ë¶„ íŒ¨í‚¤ì§€ë¥¼ rootë¡œ ê³µìœ í•˜ì§€ë§Œ,  
ê° ì•±/íŒ¨í‚¤ì§€ì˜ dependencies/ë²„ì „ì´ ë¯¸ì„¸í•˜ê²Œ ë‹¤ë¥´ë©´  
ì‹¤ì œë¡œëŠ” ê°ì ë³„ë„ì˜ node_modules/react-hook-formì´ ìƒê²¨ë²„ë¦¼.
- íŠ¹íˆ ê³µìš© UI íŒ¨í‚¤ì§€ì™€ ì•± ì–‘ìª½ì—ì„œ dependenciesì— ë™ì‹œì— react-hook-formì´ ìˆìœ¼ë©´  
ì¤‘ë³µ ì„¤ì¹˜/ë¶„ë¦¬ í˜„ìƒ ë°œìƒ.

### 3. **module federationì—ì„œ shared/singleton ë¯¸ì„¤ì •/ë¶ˆì¼ì¹˜**
- micro frontend í™˜ê²½ì—ì„œ shellê³¼ remoteê°€  
ì„œë¡œ ê°™ì€ contextë¥¼ ë°”ë¼ë³´ë ¤ë©´  
webpack/rspackì˜ module federation shared/singleton ì„¸íŒ…ì´ **ë°˜ë“œì‹œ** í•„ìš”.
- shared ì„¤ì •ì´ ëˆ„ë½ë˜ê±°ë‚˜, requiredVersionì´ ë‹¤ë¥´ê±°ë‚˜,  
remoteë§Œ sharedë¡œ, shellì€ ëˆ„ë½ ë“± ìƒí™©ì—ì„œ  
contextê°€ ì ˆëŒ€ë¡œ ì—°ê²°ë˜ì§€ ì•ŠëŠ”ë‹¤.

### 4. **ì‹¤ì œ Provider íŠ¸ë¦¬ ë¯¸êµ¬ì„±**
- ì½”ë“œìƒ `<FormProvider>`ê°€ ë°˜ë“œì‹œ EmailInputì˜ ìƒìœ„ì—ì„œ ê°ì‹¸ê³  ìˆì–´ì•¼ í•¨.
- RouterProvider ë“± react-routerì˜ Providerì™€ ë³„ê°œì„.
- contextê°€ "ëŠê¸°ëŠ” ê³³"ì´ ìˆìœ¼ë©´ useFormContext()ëŠ” null ë°˜í™˜.

---

## ğŸ› ï¸ í•´ê²° ë°©ë²•

### 1. **ê³µìš© íŒ¨í‚¤ì§€(peerDependencies), ë£¨íŠ¸ì—ë§Œ dependencies**
- `@devworld/ui`(ê³µìš© UI íŒ¨í‚¤ì§€)ì—ëŠ” react, react-dom, react-hook-formì„ **peerDependencies**ë¡œë§Œ ëª…ì‹œ.
- ì‹¤ì œ dependenciesëŠ” ë£¨íŠ¸(`root package.json`)ì—ë§Œ ì„¤ì¹˜.

### 2. **ëª¨ë“  ì•±/íŒ¨í‚¤ì§€ì—ì„œ ë²„ì „ í†µì¼**
- react, react-dom, react-hook-formì˜ ë²„ì „ì´ ë£¨íŠ¸/ê° ì•±/ê³µìš© íŒ¨í‚¤ì§€ ëª¨ë‘ì—ì„œ 100% ë™ì¼í•´ì•¼ í•¨.

### 3. **module federation shared/singleton ì„¸íŒ…**
- shell/remote(í˜¸ìŠ¤íŠ¸/ë¦¬ëª¨íŠ¸) ëª¨ë‘ì˜ webpack/rspack configì—ì„œ  
ì•„ë˜ì²˜ëŸ¼ shared/singleton ì„¸íŒ… í•„ìˆ˜:

```js
shared: {
  "react": { singleton: true, requiredVersion: "^19.0.0" },
  "react-dom": { singleton: true, requiredVersion: "^19.0.0" },
  "react-hook-form": { singleton: true, requiredVersion: "^7.59.0" },
  // ê¸°íƒ€ context ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ëª¨ë‘!
}
