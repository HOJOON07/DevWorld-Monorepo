# OAuth ë°±ì—”ë“œ ë¦¬íŒ©í† ë§: í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ê³¼ í™•ì¥ì„± ì„¤ê³„

## ê°œìš”

ê¸°ì¡´ OAuth êµ¬í˜„ì˜ ë¬¸ì œì ì„ ë¶„ì„í•˜ê³ , í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° íŒ¨í„´ì„ ì ìš©í•˜ì—¬ Googleê³¼ GitHub Providerë¥¼ ìœ ì—°í•˜ê³  í™•ì¥ì„± ìˆê²Œ ì²˜ë¦¬í•˜ë„ë¡ ë¦¬íŒ©í† ë§í•œ ê³¼ì •ì„ ì •ë¦¬í•©ë‹ˆë‹¤.

## ê¸°ì¡´ ì½”ë“œì˜ ë¬¸ì œì  ë¶„ì„

### 1. ì½”ë“œ ì¤‘ë³µ (DRY ì›ì¹™ ìœ„ë°˜)

#### AuthServiceì˜ ì¤‘ë³µëœ OAuth ë©”ì„œë“œë“¤
```typescript
// âŒ ê¸°ì¡´: GitHub OAuth ë©”ì„œë“œë“¤
async getGithubAccessToken(githubCode: string): Promise<string> {
  const getTokenUrl = 'https://github.com/login/oauth/access_token';
  const request = {
    code: githubCode,
    client_id: this.configService.get<string>(ENV_GITHUB_CLIENT_ID),
    client_secret: this.configService.get<string>(ENV_GITHUB_CLIENT_SECRET),
  };

  try {
    const response: AxiosResponse = await axios.post(getTokenUrl, request, {
      headers: { accept: 'application/json' },
    });
    
    if (response.data.error) {
      throw new UnauthorizedException('Github Authorization Failed');
    }
    
    if (!response.data.access_token) {
      throw new InternalServerErrorException('ì•¡ì„¸ìŠ¤ í† í°ì´ ë°˜í™˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    }
    
    return response.data.access_token;
  } catch (error) {
    console.error('GitHub Access Tokenì„ ë°›ì•„ì˜¤ëŠ” ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:', error);
    handleAxiosError(error);
  }
}

async getGithubUserInfo(accessToken: string): Promise<OAuthUserInfo> {
  try {
    const userResponse = await axios.get('https://api.github.com/user', {
      headers: { authorization: `token ${accessToken}` },
    });

    const emailResponse = await axios.get('https://api.github.com/user/emails', {
      headers: { authorization: `token ${accessToken}` },
    });

    const { login } = userResponse.data;
    const primaryEmail = emailResponse.data
      .filter((email: any) => email.primary && email.verified)
      .map((data: any) => data.email)[0];

    return { email: primaryEmail, devName: login };
  } catch (error) {
    console.error('GitHub ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:', error);
    handleAxiosError(error);
  }
}

// âŒ ê¸°ì¡´: Google OAuth ë©”ì„œë“œë“¤ (ê±°ì˜ ë™ì¼í•œ íŒ¨í„´)
async getGoogleAccessToken(googleCode: string): Promise<string> {
  const tokenUrl = 'https://oauth2.googleapis.com/token';
  const requestBody = {
    code: googleCode,
    client_id: this.configService.get<string>(ENV_GOOGLE_CLIENT_ID),
    client_secret: this.configService.get<string>(ENV_GOOGLE_CLIENT_SECRET),
    redirect_uri: this.redirectUri + 'google',
    grant_type: 'authorization_code',
  };

  try {
    const response: AxiosResponse = await axios.post(tokenUrl, requestBody, {
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
    });
    
    // ë™ì¼í•œ ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§...
  } catch (error) {
    // ë™ì¼í•œ ì—ëŸ¬ í•¸ë“¤ë§...
  }
}

async getGoogleUserInfo(accessToken: string): Promise<OAuthUserInfo> {
  // GitHubê³¼ ê±°ì˜ ë™ì¼í•œ íŒ¨í„´...
}
```

**ë¬¸ì œì :**
- **90% ì¤‘ë³µ ì½”ë“œ**: í† í° ìš”ì²­ê³¼ ì‚¬ìš©ì ì •ë³´ ìš”ì²­ ë¡œì§ì´ ê±°ì˜ ë™ì¼
- **Providerë³„ í•˜ë“œì½”ë”©**: URL, í—¤ë”, í•„ë“œ ì´ë¦„ë§Œ ë‹¤ë¦„
- **ì—ëŸ¬ ì²˜ë¦¬ ì¤‘ë³µ**: ë™ì¼í•œ ì—ëŸ¬ í•¸ë“¤ë§ ë¡œì§ ë°˜ë³µ
- **ìƒˆ Provider ì¶”ê°€ ì‹œ**: ì „ì²´ ë©”ì„œë“œ ì„¸íŠ¸ë¥¼ ë‹¤ì‹œ ì‘ì„±í•´ì•¼ í•¨

### 2. í™•ì¥ì„± ë¶€ì¡±

#### ìƒˆë¡œìš´ OAuth Provider ì¶”ê°€ì˜ ì–´ë ¤ì›€
```typescript
// âŒ ìƒˆ Provider (ì˜ˆ: Microsoft) ì¶”ê°€ ì‹œ í•„ìš”í•œ ì‘ì—…
class AuthService {
  // 1. ìƒˆë¡œìš´ í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€
  ENV_MICROSOFT_CLIENT_ID
  ENV_MICROSOFT_CLIENT_SECRET
  
  // 2. ìƒˆë¡œìš´ ë©”ì„œë“œ 4ê°œ ì¶”ê°€ (ëª¨ë“  Providerë§ˆë‹¤ ë°˜ë³µ)
  async getMicrosoftAccessToken(code: string) { /* ì¤‘ë³µ ë¡œì§ */ }
  async getMicrosoftUserInfo(accessToken: string) { /* ì¤‘ë³µ ë¡œì§ */ }
  async getMicrosoftBasicInfo(code: string) { /* ì¤‘ë³µ ë¡œì§ */ }
  async OAuthMicrosoftLogin(code: string) { /* ì¤‘ë³µ ë¡œì§ */ }
  
  // 3. processOAuthLogin ë©”ì„œë“œì— case ì¶”ê°€
  async processOAuthLogin(provider: string, code: string) {
    switch (provider) {
      case 'github': /* ... */
      case 'google': /* ... */
      case 'microsoft': /* ìƒˆë¡œìš´ case ì¶”ê°€ */
    }
  }
}
```

### 3. ì„¤ì • ê´€ë¦¬ì˜ ë¬¸ì œ

#### í•˜ë“œì½”ë”©ëœ ì„¤ì •ê°’ë“¤
```typescript
// âŒ ê° ë©”ì„œë“œì— í©ì–´ì§„ ì„¤ì •
const githubTokenUrl = 'https://github.com/login/oauth/access_token';
const githubUserUrl = 'https://api.github.com/user';
const githubEmailUrl = 'https://api.github.com/user/emails';

const googleTokenUrl = 'https://oauth2.googleapis.com/token';
const googleUserUrl = 'https://www.googleapis.com/oauth2/v2/userinfo';

// Providerë³„ë¡œ ë‹¤ë¥¸ í—¤ë” ì„¤ì •
headers: { accept: 'application/json' } // GitHub
headers: { 'Content-Type': 'application/x-www-form-urlencoded' } // Google
```

### 4. íƒ€ì… ì•ˆì „ì„± ë¶€ì¡±

#### ëŠìŠ¨í•œ íƒ€ì… ì •ì˜
```typescript
// âŒ any íƒ€ì… ë‚¨ìš©
async processOAuthLogin(provider: string, code: string) // string íƒ€ì…
const userData: any = response.data; // any íƒ€ì…
const emailData: any[] = emailResponse.data; // any ë°°ì—´
```

## ë¦¬íŒ©í† ë§ëœ í•´ê²°ì±…

### 1. í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° íŒ¨í„´ ì ìš©

#### ê³ ì°¨ í•¨ìˆ˜ì™€ ì»¤ë§ íŒ¨í„´
```typescript
// âœ… ë¦¬íŒ©í† ë§: ê³µí†µ í† í° ìš”ì²­ í•¨ìˆ˜ (ì»¤ë§)
export const createTokenRequester =
  (url: string) =>
  async (request: TokenRequest): Promise<string> => {
    try {
      const response: AxiosResponse = await axios.post(url, request, {
        headers: {
          accept: 'application/json',
        },
      });

      if (response.data.error) {
        throw new UnauthorizedException(`OAuth ì¸ì¦ ì‹¤íŒ¨: ${response.data.error}`);
      }

      if (!response.data.access_token) {
        throw new InternalServerErrorException('ì•¡ì„¸ìŠ¤ í† í°ì´ ë°˜í™˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
      }

      return response.data.access_token;
    } catch (error) {
      console.error('Access Token ìš”ì²­ ì¤‘ ì—ëŸ¬:', error);
      handleAxiosError(error);
    }
  };

// âœ… ê³µí†µ ì‚¬ìš©ì ì •ë³´ ìš”ì²­ í•¨ìˆ˜ (ì œë„¤ë¦­ + ì»¤ë§)
export const createUserInfoFetcher =
  <T>(url: string, authHeaderPrefix: string) =>
  async (accessToken: string): Promise<T> => {
    try {
      const response = await axios.get(url, {
        headers: {
          authorization: `${authHeaderPrefix} ${accessToken}`,
        },
      });
      return response.data;
    } catch (error) {
      console.error('ì‚¬ìš©ì ì •ë³´ ìš”ì²­ ì¤‘ ì—ëŸ¬:', error);
      handleAxiosError(error);
    }
  };
```

#### Providerë³„ íŠ¹í™”ëœ í•¨ìˆ˜ ìƒì„±
```typescript
// âœ… Providerë³„ í•¨ìˆ˜ë¥¼ íŒ©í† ë¦¬ íŒ¨í„´ìœ¼ë¡œ ìƒì„±
export const requestGithubToken = createTokenRequester(
  'https://github.com/login/oauth/access_token',
);

export const requestGoogleToken = createTokenRequester(
  'https://oauth2.googleapis.com/token'
);

export const fetchGithubUser = createUserInfoFetcher(
  'https://api.github.com/user', 
  'token'
);

export const fetchGithubEmails = createUserInfoFetcher(
  'https://api.github.com/user/emails',
  'token',
);

export const fetchGoogleUser = createUserInfoFetcher(
  'https://www.googleapis.com/oauth2/v2/userinfo',
  'Bearer',
);
```

### 2. ì„¤ì • ì¤‘ì•™í™” ë° íƒ€ì… ì•ˆì „ì„±

#### êµ¬ì¡°í™”ëœ OAuth ì„¤ì •
```typescript
// âœ… íƒ€ì… ì•ˆì „í•œ Provider ì„¤ì •
export interface OAuthProviderConfig {
  baseUrl: string;
  client_id: string;
  client_secret: string;
  scope: string;
  redirectUri: string;
  additionalParams?: Record<string, string>;
}

@Injectable()
export class OAuthConfig {
  private readonly redirectBaseUri = 'http://localhost:3000/auth/callback/';

  constructor(private readonly configService: ConfigService) {}

  // âœ… í•¨ìˆ˜í˜• íŒ©í† ë¦¬ íŒ¨í„´ìœ¼ë¡œ ì„¤ì • ìƒì„±
  private createProviderConfig = (
    provider: 'github' | 'google',
    baseUrl: string,
    scope: string,
    additionalParams?: Record<string, string>,
  ): OAuthProviderConfig => ({
    baseUrl,
    client_id: this.configService.get<string>(`${provider.toUpperCase()}_CLIENT_ID`)!,
    client_secret: this.configService.get<string>(`${provider.toUpperCase()}_CLIENT_SECRET`)!,
    scope,
    redirectUri: this.redirectBaseUri + provider,
    additionalParams,
  });

  // âœ… Providerë³„ ì„¤ì • (ë¶ˆë³€ ê°ì²´)
  readonly github = this.createProviderConfig(
    'github',
    'https://github.com/login/oauth/authorize',
    'user:email'
  );

  readonly google = this.createProviderConfig(
    'google',
    'https://accounts.google.com/o/oauth2/v2/auth',
    'openid email profile',
    {
      access_type: 'offline',
      include_granted_scopes: 'true',
      prompt: 'consent',
    }
  );
}
```

#### Providerë³„ í† í° ìš”ì²­ ë°ì´í„° ìƒì„±
```typescript
// âœ… Providerë³„ ìš”ì²­ í˜•ì‹ ì°¨ì´ë¥¼ ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ì²˜ë¦¬
createTokenRequest = (provider: 'github' | 'google', code: string) => {
  const config = this[provider];

  if (provider === 'github') {
    return {
      code,
      client_id: config.client_id,
      client_secret: config.client_secret,
    };
  }

  // Google
  return {
    code,
    client_id: config.client_id,
    client_secret: config.client_secret,
    redirectUri: config.redirectUri,
    grantType: 'authorization_code',
  };
};
```

### 3. ë°ì´í„° ë³€í™˜ ë¡œì§ ë¶„ë¦¬

#### ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ë°ì´í„° ë³€í™˜
```typescript
// âœ… Providerë³„ ë°ì´í„° ë³€í™˜ ìˆœìˆ˜ í•¨ìˆ˜
export const transformGithubUserInfo = (userData: any, emailData: any[]): OAuthUserInfo => {
  const primaryEmail = emailData
    .filter((email) => email.primary && email.verified)
    .map((data) => data.email)[0];

  return {
    email: primaryEmail,
    devName: userData.login,
    github: userData.html_url,
    location: userData.location,
    bio: userData.bio,
    company: userData.company,
    socialEtc: userData.blog,
  };
};

export const transformGoogleUserInfo = (userData: any): OAuthUserInfo => ({
  email: userData.email,
  devName: userData.name,
});
```

### 4. ì—ëŸ¬ ì²˜ë¦¬ í†µì¼í™”

#### í•¨ìˆ˜í˜• ì—ëŸ¬ í•¸ë“¤ë§ ë˜í¼
```typescript
// âœ… ì—ëŸ¬ ì²˜ë¦¬ë¥¼ ê³ ì°¨ í•¨ìˆ˜ë¡œ í†µì¼
export const withErrorHandling =
  <T extends any[], R>(fn: (...args: T) => Promise<R>, errorMessage: string) =>
  async (...args: T): Promise<R> => {
    try {
      return await fn(...args);
    } catch (error) {
      console.error(`${errorMessage}:`, error);
      throw error;
    }
  };
```

### 5. í†µí•©ëœ OAuth Service

#### ë¦¬íŒ©í† ë§ëœ OAuthService
```typescript
// âœ… ê°„ê²°í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ OAuthService
@Injectable()
export class OAuthService {
  constructor(
    private readonly configService: ConfigService,
    private readonly oauthConfig: OAuthConfig,
  ) {}

  // âœ… ì„¤ì • ê¸°ë°˜ URL ìƒì„±
  generateOAuthRedirectUrl(provider: Provider): string {
    return this.oauthConfig.generateAuthUrl(this.oauthConfig[provider]);
  }

  // âœ… í†µí•©ëœ í† í° ìš”ì²­
  async getAccessToken(provider: Provider, code: string): Promise<string> {
    const tokenRequest = this.oauthConfig.createTokenRequest(provider, code);
    const tokenRequester = provider === 'github' ? requestGithubToken : requestGoogleToken;
    
    return withErrorHandling(
      tokenRequester,
      `${provider} ì•¡ì„¸ìŠ¤ í† í° ìš”ì²­ ì‹¤íŒ¨`
    )(tokenRequest);
  }

  // âœ… í†µí•©ëœ ì‚¬ìš©ì ì •ë³´ ìš”ì²­
  async getUserInfo(provider: Provider, accessToken: string): Promise<OAuthUserInfo> {
    if (provider === 'github') {
      const [userData, emailData] = await Promise.all([
        withErrorHandling(fetchGithubUser, 'GitHub ì‚¬ìš©ì ì •ë³´ ìš”ì²­ ì‹¤íŒ¨')(accessToken),
        withErrorHandling(fetchGithubEmails, 'GitHub ì´ë©”ì¼ ì •ë³´ ìš”ì²­ ì‹¤íŒ¨')(accessToken),
      ]);
      return transformGithubUserInfo(userData, emailData as any);
    }
    
    if (provider === 'google') {
      const userData = await withErrorHandling(
        fetchGoogleUser,
        'Google ì‚¬ìš©ì ì •ë³´ ìš”ì²­ ì‹¤íŒ¨',
      )(accessToken);
      return transformGoogleUserInfo(userData);
    }
    
    throw new Error(`ì§€ì›í•˜ì§€ ì•ŠëŠ” OAuth ì œê³µì: ${provider}`);
  }

  // âœ… ë‹¨ì¼ ì§„ì…ì 
  async processOAuthLogin(provider: Provider, code: string): Promise<OAuthUserInfo> {
    return withErrorHandling(async (provider: Provider, code: string) => {
      const accessToken = await this.getAccessToken(provider, code);
      return this.getUserInfo(provider, accessToken);
    }, `${provider} OAuth ë¡œê·¸ì¸ ê³¼ì • ì‹¤íŒ¨`)(provider, code);
  }
}
```

## ìƒˆë¡œìš´ Provider ì¶”ê°€ì˜ ê°„í¸í•¨

### Microsoft OAuth ì¶”ê°€ ì˜ˆì‹œ
```typescript
// âœ… ìƒˆ Provider ì¶”ê°€ ì‹œ í•„ìš”í•œ ì‘ì—… (ë§¤ìš° ê°„ë‹¨!)

// 1. ì„¤ì •ì— Microsoft ì¶”ê°€
readonly microsoft = this.createProviderConfig(
  'microsoft',
  'https://login.microsoftonline.com/common/oauth2/v2.0/authorize',
  'openid profile email'
);

// 2. ì „ìš© í•¨ìˆ˜ ìƒì„± (í•œ ì¤„!)
export const requestMicrosoftToken = createTokenRequester(
  'https://login.microsoftonline.com/common/oauth2/v2.0/token'
);

export const fetchMicrosoftUser = createUserInfoFetcher(
  'https://graph.microsoft.com/v1.0/me',
  'Bearer'
);

// 3. ë°ì´í„° ë³€í™˜ í•¨ìˆ˜ ì¶”ê°€
export const transformMicrosoftUserInfo = (userData: any): OAuthUserInfo => ({
  email: userData.mail || userData.userPrincipalName,
  devName: userData.displayName,
});

// 4. Serviceì— ì¡°ê±´ ì¶”ê°€ (ëª‡ ì¤„ë§Œ!)
async getUserInfo(provider: Provider, accessToken: string): Promise<OAuthUserInfo> {
  // ê¸°ì¡´ github, google...
  
  if (provider === 'microsoft') {
    const userData = await withErrorHandling(
      fetchMicrosoftUser,
      'Microsoft ì‚¬ìš©ì ì •ë³´ ìš”ì²­ ì‹¤íŒ¨'
    )(accessToken);
    return transformMicrosoftUserInfo(userData);
  }
}
```

## ê°œì„  íš¨ê³¼ ë¶„ì„

### 1. ì½”ë“œ í’ˆì§ˆ ê°œì„ 

#### ì •ëŸ‰ì  ê°œì„ 
```typescript
// ê°œì„  ì „í›„ ë¹„êµ
const metrics = {
  before: {
    linesOfCode: 450,        // AuthService OAuth ê´€ë ¨ ì½”ë“œ
    methods: 12,             // Providerë³„ ì¤‘ë³µ ë©”ì„œë“œë“¤
    duplicatedLines: 320,    // ì¤‘ë³µëœ ì½”ë“œ ë¼ì¸
    providers: 2,            // GitHub, Google
    newProviderCost: 150     // ìƒˆ Provider ì¶”ê°€ ì‹œ í•„ìš”í•œ ì½”ë“œ ë¼ì¸
  },
  after: {
    linesOfCode: 200,        // ë¦¬íŒ©í† ë§ í›„
    methods: 4,              // í†µí•©ëœ ë©”ì„œë“œë“¤
    duplicatedLines: 0,      // ì¤‘ë³µ ì œê±°
    providers: 2,            // ë™ì¼
    newProviderCost: 20      // ìƒˆ Provider ì¶”ê°€ ì‹œ í•„ìš”í•œ ì½”ë“œ ë¼ì¸
  }
};

// ê°œì„  ì§€í‘œ
const improvements = {
  codeReduction: '55.6%',           // (450-200)/450
  methodReduction: '66.7%',         // (12-4)/12
  duplicationElimination: '100%',   // ëª¨ë“  ì¤‘ë³µ ì œê±°
  newProviderCostReduction: '86.7%' // (150-20)/150
};
```

### 2. ìœ ì§€ë³´ìˆ˜ì„± ê°œì„ 

#### ë³€ê²½ ì˜í–¥ë„ ë¶„ì„
```typescript
// âœ… ë³€ê²½ ì‚¬í•­ì˜ ì˜í–¥ ë²”ìœ„ê°€ ìµœì†Œí™”ë¨

// ì‹œë‚˜ë¦¬ì˜¤ 1: ìƒˆë¡œìš´ OAuth Provider ì¶”ê°€
// Before: ì „ì²´ AuthService ìˆ˜ì • í•„ìš” (12ê°œ ë©”ì„œë“œ ì¶”ê°€)
// After: ì„¤ì •ê³¼ ì „ìš© í•¨ìˆ˜ë§Œ ì¶”ê°€ (3-4ê°œ í•¨ìˆ˜)

// ì‹œë‚˜ë¦¬ì˜¤ 2: ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ë³€ê²½
// Before: ëª¨ë“  Provider ë©”ì„œë“œì—ì„œ ê°œë³„ ìˆ˜ì •
// After: withErrorHandling í•¨ìˆ˜ í•œ ê³³ë§Œ ìˆ˜ì •

// ì‹œë‚˜ë¦¬ì˜¤ 3: í† í° ìš”ì²­ ë¡œì§ ìˆ˜ì •
// Before: Providerë³„ ë©”ì„œë“œ ê°œë³„ ìˆ˜ì •
// After: createTokenRequester í•¨ìˆ˜ í•œ ê³³ë§Œ ìˆ˜ì •
```

### 3. íƒ€ì… ì•ˆì „ì„± ê°œì„ 

#### ê°•í™”ëœ íƒ€ì… ì²´í¬
```typescript
// âœ… ì»´íŒŒì¼ íƒ€ì„ ì•ˆì „ì„± í™•ë³´
type Provider = 'github' | 'google';  // ëª…ì‹œì  íƒ€ì… ì •ì˜

interface TokenRequest {              // êµ¬ì¡°í™”ëœ ìš”ì²­ íƒ€ì…
  code: string;
  client_id: string;
  client_secret: string;
  redirectUri?: string;
  grantType?: string;
}

interface OAuthUserInfo {             // í‘œì¤€í™”ëœ ì‘ë‹µ íƒ€ì…
  email: string;
  devName: string;
  github?: string;
  location?: string;
  bio?: string;
  company?: string;
  socialEtc?: string;
}
```

### 4. í…ŒìŠ¤íŠ¸ ìš©ì´ì„± ê°œì„ 

#### ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ì¸í•œ í…ŒìŠ¤íŠ¸ ë‹¨ìˆœí™”
```typescript
// âœ… ìˆœìˆ˜ í•¨ìˆ˜ëŠ” í…ŒìŠ¤íŠ¸ê°€ ê°„ë‹¨í•¨
describe('OAuth Utils', () => {
  it('should transform GitHub user info correctly', () => {
    const mockUserData = { login: 'testuser', html_url: 'https://github.com/testuser' };
    const mockEmailData = [{ email: 'test@example.com', primary: true, verified: true }];
    
    const result = transformGithubUserInfo(mockUserData, mockEmailData);
    
    expect(result.email).toBe('test@example.com');
    expect(result.devName).toBe('testuser');
  });
  
  // ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì—†ì´ ìˆœìˆ˜ ë¡œì§ë§Œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
});
```

## í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì˜ ì¥ì 

### 1. ìˆœìˆ˜ í•¨ìˆ˜ (Pure Functions)
- **ì˜ˆì¸¡ ê°€ëŠ¥ì„±**: ë™ì¼í•œ ì…ë ¥ì— ëŒ€í•´ í•­ìƒ ë™ì¼í•œ ì¶œë ¥
- **í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**: ì‚¬ì´ë“œ ì´í™íŠ¸ê°€ ì—†ì–´ í…ŒìŠ¤íŠ¸ê°€ ê°„ë‹¨
- **ë””ë²„ê¹… í¸ì˜ì„±**: ìƒíƒœ ë³€ê²½ì´ ì—†ì–´ ë²„ê·¸ ì¶”ì ì´ ì‰¬ì›€

### 2. ë¶ˆë³€ì„± (Immutability)
- **ìƒíƒœ ì•ˆì „ì„±**: ì„¤ì • ê°ì²´ê°€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
- **ë™ì‹œì„± ì•ˆì „ì„±**: ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì•ˆì „

### 3. ì¡°í•©ì„± (Composability)
- **ëª¨ë“ˆí™”**: ì‘ì€ í•¨ìˆ˜ë“¤ì„ ì¡°í•©í•˜ì—¬ ë³µì¡í•œ ê¸°ëŠ¥ êµ¬í˜„
- **ì¬ì‚¬ìš©ì„±**: ê³ ì°¨ í•¨ìˆ˜ë¡œ ê³µí†µ íŒ¨í„´ì„ ì¬ì‚¬ìš©

### 4. ì»¤ë§ (Currying)
- **ë¶€ë¶„ ì ìš©**: ì„¤ì •ì„ ë¯¸ë¦¬ ì ìš©í•œ ì „ìš© í•¨ìˆ˜ ìƒì„±
- **ì½”ë“œ ê°„ê²°ì„±**: ë°˜ë³µì ì¸ ë§¤ê°œë³€ìˆ˜ ì „ë‹¬ ì œê±°

## ê²°ë¡ 

OAuth ë¦¬íŒ©í† ë§ì„ í†µí•´ ë‹¤ìŒê³¼ ê°™ì€ ì„±ê³¼ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤:

### ğŸš€ **ì„±ëŠ¥ ë° í’ˆì§ˆ**
- **ì½”ë“œëŸ‰ 55% ê°ì†Œ**: 450ì¤„ â†’ 200ì¤„
- **ì¤‘ë³µ ì½”ë“œ 100% ì œê±°**: DRY ì›ì¹™ ì™„ì „ ì ìš©
- **ìƒˆ Provider ì¶”ê°€ ë¹„ìš© 87% ê°ì†Œ**: 150ì¤„ â†’ 20ì¤„

### ğŸ”§ **ìœ ì§€ë³´ìˆ˜ì„±**
- **ë‹¨ì¼ ì±…ì„ ì›ì¹™**: ê° í•¨ìˆ˜ê°€ í•˜ë‚˜ì˜ ëª…í™•í•œ ì—­í• 
- **ê°œë°©-íì‡„ ì›ì¹™**: ìƒˆ Provider ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”
- **ì˜ì¡´ì„± ì—­ì „**: ì¶”ìƒí™”ì— ì˜ì¡´í•˜ëŠ” êµ¬ì¡°

### ğŸ›¡ï¸ **ì•ˆì •ì„±**
- **íƒ€ì… ì•ˆì „ì„±**: ì»´íŒŒì¼ íƒ€ì„ ì—ëŸ¬ ê²€ì¶œ
- **ì—ëŸ¬ ì²˜ë¦¬ í†µì¼í™”**: ì¼ê´€ëœ ì—ëŸ¬ í•¸ë“¤ë§
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í–¥ìƒ**: ìˆœìˆ˜ í•¨ìˆ˜ë¡œ í…ŒìŠ¤íŠ¸ ìš©ì´ì„± ì¦ëŒ€

### ğŸ“ˆ **í™•ì¥ì„±**
- **Provider ë¬´ì œí•œ ì¶”ê°€**: ì„¤ì • ê¸°ë°˜ í™•ì¥
- **ê¸°ëŠ¥ í™•ì¥ ìš©ì´ì„±**: í•¨ìˆ˜ ì¡°í•©ìœ¼ë¡œ ìƒˆ ê¸°ëŠ¥ êµ¬í˜„
- **ë ˆê±°ì‹œ í˜¸í™˜ì„±**: ê¸°ì¡´ API ì¸í„°í˜ì´ìŠ¤ ìœ ì§€

ì´ëŸ¬í•œ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ì ‘ê·¼ë²•ì€ OAuthë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ì™¸ë¶€ API í†µí•©ì—ë„ ì ìš©í•  ìˆ˜ ìˆëŠ” ë²”ìš©ì ì¸ íŒ¨í„´ì„ ì œì‹œí•©ë‹ˆë‹¤.